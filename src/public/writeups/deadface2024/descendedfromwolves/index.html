<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">CTF writeups - Descended From Wolves</title>
<meta property="og:title" content=CTF&#32;writeups&#32;-&#32;Descended&#32;From&#32;Wolves />
<meta name="twitter:title" content=CTF&#32;writeups&#32;-&#32;Descended&#32;From&#32;Wolves />
<meta itemprop="name" content=CTF&#32;writeups&#32;-&#32;Descended&#32;From&#32;Wolves />
<meta name="application-name" content=CTF&#32;writeups&#32;-&#32;Descended&#32;From&#32;Wolves />
<meta property="og:site_name" content="My CTF writeups" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://ctf.harbiinger.xyz/writeups/deadface2024/descendedfromwolves/" />
<link rel="canonical" href="https://ctf.harbiinger.xyz/writeups/deadface2024/descendedfromwolves/" itemprop="url" />
<meta name="url" content="https://ctf.harbiinger.xyz/writeups/deadface2024/descendedfromwolves/" />
<meta name="twitter:url" content="https://ctf.harbiinger.xyz/writeups/deadface2024/descendedfromwolves/" />
<meta property="og:url" content="https://ctf.harbiinger.xyz/writeups/deadface2024/descendedfromwolves/" />


<meta property="og:updated_time" content="2024-10-06T00:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://ctf.harbiinger.xyz/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="My CTF writeups" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.135.0">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #fff;
        --code-background-color: #515151;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://ctf.harbiinger.xyz/">
                <img src="/images/nix-mate-trans.png" alt="brand image">
            </a>
        
        
            <a href="https://ctf.harbiinger.xyz/">
                <h1>CTF writeups</h1>
            </a>
        
    </h1>
    <p class="lead">
    ctf writeups, tips, tools, ...
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/events/">Events</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://ctf.harbiinger.xyz/events/deadface2024/deadface2024/">DeadFace 2024</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/harbiinger/ctf-writeup">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>







    <a target="_blank" class="social" rel="me" title="Mastodon" href="https://fosstodon.org/@harbinger">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26c-1.31.15-2.6.3-3.97.24c-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42c1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5c-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56 0 5.02.3 6.47.96c0 0 2.83 1.27 2.83 5.61c0 0 .04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56c-.56-.63-1.3-.96-2.23-.96c-1.06 0-1.87.41-2.42 1.23l-.5.88l-.5-.88c-.56-.82-1.36-1.23-2.43-1.23c-.92 0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62c1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93c.9 0 1.35.56 1.35 1.62v5.11H18V8.91Z"/>
        </svg>
    </a>















        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 My CTF writeups. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://ctf.harbiinger.xyz/writeups/deadface2024/descendedfromwolves/">Descended From Wolves</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2024-10-06T00:00:00Z" class="post-date">
        October 6, 2024
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>3 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-STEGANOGRAPHY">
        <a href="https://ctf.harbiinger.xyz/tags/steganography">STEGANOGRAPHY</a>
      </li>
      
    </ul>
    
  </div>

  
  
  <p class="seriesname">
    Series: <a href="https://ctf.harbiinger.xyz/series/deadface2024">deadface2024</a>
  </p>
  

  
</div>

  <h2 id="challenge-description">Challenge Description</h2>
<blockquote>
<p>There’s an image circulating on GhostTown of some weird dog. Based on the conversation in the forum, it sounds like the image holds some data that lamia415 extracted from De Monne Financial. Use the context in the conversation to determine what was extracted.</p>
</blockquote>
<blockquote>
<p>Submit the flag as flag{flag-text}.</p>
</blockquote>
<h2 id="file">File</h2>
<p><img src="/deadface2024/princess.png" alt="Image of a dog with big eyes"></p>
<h2 id="solution">Solution</h2>
<p>In <code>GhostTown</code>, there is a thread titled <code>Exfiltrating Data Without Triggering Alerts</code> that says</p>
<blockquote>
<p>Hey everyone, I just pulled off a sweet exfiltration from my company without setting off any security alerts. Sent a simple PNG of my dog, and no one suspected a thing!</p>
</blockquote>
<blockquote>
<p>This is the image I used. He’s standing over his dog bowl in the original image.</p>
</blockquote>
<p>This post implies that the image has been cropped but maybe the data has not been deleted.</p>
<p>If we read the PNG specification from: <a href="http://www.libpng.org/pub/png/spec/1.2/PNG-Structure.html" target="_blank">http://www.libpng.org/pub/png/spec/1.2/PNG-Structure.html</a>
we see that each PNG file must start with a IHDR header:</p>
<pre tabindex="0"><code>3.1 PNG file signature

The first eight bytes of a PNG file always contain the following values:

   (decimal)              137  80  78  71  13  10  26  10
   (hexadecimal)           89  50  4e  47  0d  0a  1a  0a
   (ASCII C notation)    \211   P   N   G  \r  \n \032 \n

This signature indicates that the remainder of the file contains a single PNG image, consisting of a series of chunks beginning with an IHDR chunk and ending with an IEND chunk. 

3.2 Chunk layout

Each chunk consists of four parts:

Length
    A 4-byte unsigned integer giving the number of bytes in the chunk&#39;s data field. The length counts only the data field, not itself, the chunk type code, or the CRC. Zero is a valid length. Although encoders and decoders should treat the length as unsigned, its value must not exceed 231 bytes.

Chunk Type
    A 4-byte chunk type code. For convenience in description and in examining PNG files, type codes are restricted to consist of uppercase and lowercase ASCII letters (A-Z and a-z, or 65-90 and 97-122 decimal). However, encoders and decoders must treat the codes as fixed binary values, not character strings. For example, it would not be correct to represent the type code IDAT by the EBCDIC equivalents of those letters. Additional naming conventions for chunk types are discussed in the next section.

Chunk Data
    The data bytes appropriate to the chunk type, if any. This field can be of zero length.

CRC
    A 4-byte CRC (Cyclic Redundancy Check) calculated on the preceding bytes in the chunk, including the chunk type code and chunk data fields, but not including the length field. The CRC is always present, even for chunks containing no data. See CRC algorithm.

The chunk data length can be any number of bytes up to the maximum; therefore, implementors cannot assume that chunks are aligned on any boundaries larger than bytes.

Chunks can appear in any order, subject to the restrictions placed on each chunk type. (One notable restriction is that IHDR must appear first and IEND must appear last; thus the IEND chunk serves as an end-of-file marker.) Multiple chunks of the same type can appear, but only if specifically permitted for that type. 
</code></pre><p>We need to find the block that contains the height (733) of the image and modify it. Then recalculate the CRC.</p>
<p><img src="/deadface2024/descendedFromWolves-1.png" alt="HexDump of the image">
The highlighted bytes correspond to 1024 733.
Let&rsquo;s change 02 dd to 04 dd.
We need to calculate the new CRC:</p>
<pre tabindex="0"><code>import zlib

ihdr_data = bytes.fromhex(&#39;4948445200000400000004dd0803000000&#39;)
crc = zlib.crc32(ihdr_data) &amp; 0xffffffff
print(f&#39;{crc:08X}&#39;)
</code></pre><p>which gives us: 23 C4 EA CE</p>
<p>We can now replace the bytes and render the image:</p>
<p><img src="/deadface2024/descendedFromWolves-2.png" alt="CyberChef recipe for rendering the image"></p>
<p>Full image:
<img src="/deadface2024/descendedFromWolves-3.png" alt="Image of the dog with the flag written on its bowl"></p>
<p>Flag: flag{th3_h4ndsom3st_b01_1n_th3_w0rld}</p>

  
  <hr>
<div class="footer">
    
    
    
    <p>
    This is a post in the <b><a href="https://ctf.harbiinger.xyz/series/deadface2024">deadface2024</a></b> series.
        <br>Other posts in this series:
        <ul class="series">
            
            
            
            <li>
                October 6, 2024 -
                
                    <a href="/writeups/deadface2024/deeppockets/">Deep Pockets</a>
                
            </li>
            
            <li>
                October 6, 2024 -
                
                    Descended From Wolves
                
            </li>
            
            <li>
                October 6, 2024 -
                
                    <a href="/writeups/deadface2024/electricsoldiers/">Electric Soldiers</a>
                
            </li>
            
        </ul>
    </p>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#challenge-description">Challenge Description</a></li>
    <li><a href="#file">File</a></li>
    <li><a href="#solution">Solution</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
